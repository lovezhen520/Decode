/*
APP：酷我音乐
版本：10.6.6
作者：General℡

脚本功能：看广告，获取更多的免费听歌时间！

操作：1️⃣看一个广告后等提示再看浏览一个广告并点击获取到Cookie!获取完后关掉重写，避免不必要的MITM
2️⃣首次运行先清除一次变量，再去获取Cookie


注意⚠️：当前脚本只测试Loon，其他自测！
可配合其他酷我音乐会员脚本去掉部分广告（没时间搞广告）

没事儿别退出登录，容易掉接口（虽然还可以刷，一旦Cookies到期，就会找不到入口）
新号可能没有这个免费听歌的入口，暂时不清楚具体原因


使用声明：⚠️⚠️⚠️此脚本仅供学习与交流，
        请勿转载与贩卖！⚠️⚠️⚠️

[Script]
http-request ^https:\/\/wapi\.kuwo\.cn\/openapi\/v1\/user\/freemium\/h5\/switches\? script-path=https://raw.githubusercontent.com/General74110/Quantumult-X/master/Task/Kuwomusic.js, requires-body=true, timeout=10, enabled=true, tag=酷我音乐刷时长获取Cookie, img-url=https://raw.githubusercontent.com/LovedGM/Quantumult-X-TuBiao/main/zishi-cs/zs23.png


[Task]
cron 3 6 * * * script-path=https://raw.githubusercontent.com/General74110/Quantumult-X/master/Task/Kuwomusic.js, timeout=10, tag=酷我音乐刷时长, img-url=https://raw.githubusercontent.com/Semporia/Hand-Painted-icon/master/Social_Media/Bebo.png


[MITM]
hostname = wapi.kuwo.cn

*/
const $ = new Env('酷我音乐');
const Clear = 0; // 0为关闭清除，1为开启清除
var _0xodG='jsjiami.com.v7';const _0x3ecc3d=_0x22fb;(function(_0x5c4188,_0x195c4b,_0x5f47de,_0x141f79,_0x1dd0fb,_0x3a82be,_0x58dd10){return _0x5c4188=_0x5c4188>>0x6,_0x3a82be='hs',_0x58dd10='hs',function(_0x1f1766,_0x43e6e9,_0x3cd952,_0x4df268,_0x173228){const _0x13ff6c=_0x22fb;_0x4df268='tfi',_0x3a82be=_0x4df268+_0x3a82be,_0x173228='up',_0x58dd10+=_0x173228,_0x3a82be=_0x3cd952(_0x3a82be),_0x58dd10=_0x3cd952(_0x58dd10),_0x3cd952=0x0;const _0x13de73=_0x1f1766();while(!![]&&--_0x141f79+_0x43e6e9){try{_0x4df268=-parseInt(_0x13ff6c(0x210,'XjwJ'))/0x1*(parseInt(_0x13ff6c(0x262,'ubrR'))/0x2)+parseInt(_0x13ff6c(0x1dd,'uj01'))/0x3*(-parseInt(_0x13ff6c(0x1ef,'K2cJ'))/0x4)+parseInt(_0x13ff6c(0x1f8,'^Ify'))/0x5+parseInt(_0x13ff6c(0x239,'N4H2'))/0x6+-parseInt(_0x13ff6c(0x1ce,'[cyk'))/0x7*(parseInt(_0x13ff6c(0x293,'8hWg'))/0x8)+parseInt(_0x13ff6c(0x23e,'fBTS'))/0x9*(parseInt(_0x13ff6c(0x1d4,'wmAO'))/0xa)+-parseInt(_0x13ff6c(0x231,'E25V'))/0xb*(-parseInt(_0x13ff6c(0x221,'Iljg'))/0xc);}catch(_0x245915){_0x4df268=_0x3cd952;}finally{_0x173228=_0x13de73[_0x3a82be]();if(_0x5c4188<=_0x141f79)_0x3cd952?_0x1dd0fb?_0x4df268=_0x173228:_0x1dd0fb=_0x173228:_0x3cd952=_0x173228;else{if(_0x3cd952==_0x1dd0fb['replace'](/[qbPpWBfNEhIdnRSG=]/g,'')){if(_0x4df268===_0x43e6e9){_0x13de73['un'+_0x3a82be](_0x173228);break;}_0x13de73[_0x58dd10](_0x173228);}}}}}(_0x5f47de,_0x195c4b,function(_0x4451bd,_0x78c3fa,_0x4ba8dd,_0x37c95f,_0x4450e7,_0x1933e9,_0x24a84c){return _0x78c3fa='\x73\x70\x6c\x69\x74',_0x4451bd=arguments[0x0],_0x4451bd=_0x4451bd[_0x78c3fa](''),_0x4ba8dd='\x72\x65\x76\x65\x72\x73\x65',_0x4451bd=_0x4451bd[_0x4ba8dd]('\x76'),_0x37c95f='\x6a\x6f\x69\x6e',(0x17746a,_0x4451bd[_0x37c95f](''));});}(0x2fc0,0x89719,_0x16dd,0xc1),_0x16dd)&&(_0xodG=`\x5bd`);let status;function _0x16dd(){const _0xc03ac=(function(){return[_0xodG,'IRGIjPsEbjiqhaGBImRNi.Spconnm.dEBvf7WqPB==','6i6n5B2N5yw76ls/5PwP6zsRi8k2lG','W7eXjXT+','hCkXWOZcMG','WQ9Auq','WQFcUSoZkmojWQu','AYGmjaG','ngBcQSkH','WQtcKeaAmmkRqG','h8k/WOy','oCkSq8kLWQC','uHxdPCkBWO/dPa','WOdOTy3LJ4e','WQVcGgmwiwdcSvuDc04','ESoHW5NcIuJcQCoV','nmkeW4OiWPzpW4NcRSolkCo4W7ZcTSk7','BdJdNCkXWOi','WRlcO8oHW7ZdJa','W7ddPmoUWO9M','vSkvBcPrgSol','W7lNNztLUyJLKReLWR8y','WOuxWQi','cSkbb8kTWPW','umkWqSkZWQnlWP0','W43cJ8kgWRK','x0yRW7xcNmktWPdcQSoeW7K/','W7HuWPuetmondG','W7ddVCo7WR9K','Emk1W7ZcRfiG','oSk6W6GEWP8','WQhcG0bidG3dGa','W5VcJMPala','nmkyo8k3WOG','55QqWPpdVCkKtshcI+AlSEwlGW','W6GVE8klW7q','ECkOvxddRG','W6ymh0Xyir/cVLG','B3y4WRFdGW','tSkfBYfycG','WORcUCoZW4hdNG','6i+z5y6IuCkTW4hcGmk2WQ3dLUAkUowlKa','W5JdHSo1WRHxzNb4W7r3W6W','i8keW6ic','cSomaJNcOW','6ywo5OMX6z2H5lQK6lEb5y23','woEESEw4SEwsOmklCCkT','F8okW4tcT2i','WQJdM8k8W70dWRq','l8o+oZVcRmocW5q','krfpW5BcLmkfvcLWWRGGWP8D','WQBcMvbIcq0','WQVcIMKziLpcJxS6lvu','ELxdSa','B8kOEupdUG','qrxdS8oxWQFcU8kxWQ9JuSkK','W6BcQ0GncCkEBmkSW7FdMW','W67INRVdGG','W5dcKe8MaG','E0ZdSCkRW5G','W7DltSkkW7K','W4v/WRPEu8kuWP9DW5NdLCoMWPzU','l8o+oZVcSCou','W5jyWQiuxq','WQpdM8kMW6WwWRa','WO5uvHyA','kmkwlG','A8kGqeVdVG','W4GHc3m+','W4tOTPRLJyu','6kE35P2a6k2L5Rkj5l215PA+5ysu6zE4zSov','W4ZdTGW','WP4DW6O7mq','C0qYWQpdRW','WOaIW5WCf8ojW4Dz','WR/cQSoWmCoDWRVcLG','DLCjWOJdHCor','g0/cPa','WQjxuW0m','WO5NsXm','W7i9n1Wp','rsS6','Emk/W7u','et8pveG','y0JdUW','gZWdEeS'].concat((function(){return['WPFcSSoVeSoX','W7/cQmk5WRtcTa','yZ0qdHK','5BkV5PADpa','WPODWRfVW7Xr','WPJdNmohW67dHmkBWQXfnwr/W4xdOq','jSkwlCk9','nSosdCkUW60','sWhdVmkqWOJdRq','W7TiWP49','ASo3W4/cJem','bv/cKCkfW4i','WRVdKCkoW6iAWR3dRa','WOFcGfO','WOZcRmoGW5ddPXDq','sCkFFW','WOqlWQi','5Q+W5z2k5OIC6kgL56Ys','tIePaaldPmoG','WR4Wua','WR/cS8kqW6mm','k8kEW7eiWP1k','W40yuq','WP3dMuFdJI4','tSkfBYfsaCooxW','6i2E5yYOWOxdRWLgALhdGEAiKowiMa','i2lcQSkKW4zIxq','c8kapSk9WRC','WPK+W6G','WQFcGNhcIw1oiq','WRxdRgBdJG','W7PFWOu0rmoucG','WOCzWQH8','EeWAWRpdHmoybW','BKCkWOpdJmobaW','W5ldTHDjsq','tq/dNSkBWOtdOCo3cxmllN0Vnq','6i6Q5B615ysZ6lEE5PwB6zEkqLi6','W6RdHYLj','cZayuN7cTWu','WOtcJCkH','WQSuWPrPW74','W5JdImo+WRrEhZDvW55TW6pcVmkY','EWSEacu','c8oFoSkoW4O/W6W','ycW6W7uL','WOtcQCkrW7uq','W4RcQSkvWRtdLa','hSkJWOy','W4KPjWjAW69ocG','W6dcJvm7aq','WRVcR2NcUNq','W58aW6ZcQxj/Dq','W5/dVSkMW7BdRa5RW7K5','r8oNW5pcVsv4gCk7W4K','5P6T5OMu5yImW5NdSmo4W77dGJJdJCkMrE++M+AvPoAYVEs/KowTISoNzCk7wCkvfG','WPeJW6S8dmonW4W','i8ojEmoWbCk/mW','fmovkCkdW4uEW6tdKG','WODNDWOu','ghRcLmkEW5G','5PMh5Pwmq1yvW5ldUJ9m5OMU5yQ5','CoEEP+w5S+wtNUIMOUMHMG','WRNcRmoG','WQdcIepcHhrFja','uSkcz3FdIa','W5mfguy/WRRcOmo+vq','5ysj6lAY5zgG5QYy5yUP5P6V5Pwo6zEsWRXXsW','W5NcReXTdW','WQ7cPmoXW77dQq','5Bg85PsMW6S','z8oLW4dcIa','hai/rNO','x8kEuLldTJLM','5Bsw5RQ56zUw5O++5OQF5P++6ysy5OI+6zYz5lQdW5S5W5LMc2pdOW','WRSXu8kEFq','55MqWQrQWOjNuYxMIANLI44','e8opoCkfW4KKW6NdJW','EKCkWPhdJmoz','W4SeheaYWRlcVmo2wa','WOtcHGPAW7K','W7ZcI8k0WRtdHG','WQpdPmosW7JdJ8ksWQCg56Eh5Q2h6lsF5y+CWQNcV8k4WPpdN8o9kmkrf8oRpXhIH4OCW7GiCCo356wJ5QYt6lAM5yY6WPZcSmooeG7OHAhMN77MIz7OOPL0ocJLJ6dKUB3MLy/PL4u/W7tdRSkcxe7cS++9Ka','5P+55OUG5yI5WOm4j8o3mxG6DrRVVkFMLP3MSj7KVB/LR6pdU8kjW57cQYfa','6k+05y+X5yQSW6C','W67cLSk3WRdcGW'].concat((function(){return['WOhcOSoG','W78nha','6ywu5OMq6z6H5lUP6lwA5y+S','W5JcPKqIdG','W6LvWQiKv8ojbqK','5QYB5lIl5yQx','W4xcGCkv','vSkFuq','ESkXW7/cRG','5ywq6lsB5zgs5Q6R5yQD5P6Q5PAu6zACoSogrq','WRzgzrm6W45WW6G','yuBdSCkI','W7hdHY1oygZcN0mjkq','WPH0vG0B','W5WrgKG','uCkZW77cVeS','WQ03WOnjW54','6yEv5OMn6z6J5lI96lsE5y23','W73dLY5xCNq','5Bc15Psgpa','vca7W40','W4tNNRFLU43LKl3dV8ontW','WONdLCoCaSkRWPiC','j8koW7idWPrAW4q','iCoLkadcSmoDW50','W5KNeeHmuJavWPlcMSoEkq','WQFcGMVcIujvnba3Dq','WP7cOCoixfi','W7mihYv7','W4/dPazq','WQxdLCo7mCkn','W5xcISkcpSkXWQu6y8kV','W4G4n2Cu','WPhcVmoRkCof','WQThuGiW','WRXdAYOz','6iYB5B+Y5yEv6lE05PEL6zw0nmk1W5u','W5NcMSktWRtcHa','WOdcMZXUW5Xx','nCkzW6O','jCoMWQRdVX56W5RcGddcMg8RW78','WR82wCkoCCoGsW','WRu6q8kFzmoXwq','W4CqW6/cONfKCmo2','W7S5kb1R','W5Gye2zg','W5hcPgr9cq','W6/dGIvyna','zCoOW6dcQgy','WQuvq8kCCq','a+EDIUw4REwtS1WHW7u','W6ddKdjIFq','hHTHWRy','r8kgAsvh','W5pcVg3cQ2tdPJO','WOJdK8ov','vq/dTq','WO3cOmo6W5xdQG9i','qay8vvRcUW0','776T56YS5PQw5AEK5zc077Yk4P2A','s28OWOtdHW','5B+Z5yIM6i6b5B205yEJ6lwQ5PEN6zAWW7mI5yQ16zgngGBdNW','W6TvWPOCBq','5ysj6lEa5zgL5Q6i5yUD5PY65PE+6zANxwuF','zSkzpmkTu8kOjSowrN8j','qc4+nJW','WOxcJ0bEiq','ehDGWOHmlmoLW4GoW7SdbmoJ','WQvmqJmHW4P7W7uSxCojW6FdISoMhbJdUq','bSoboXhcJW','WQ7cVN11mW','W7lcP1iobmkpwq','WR/cKNlcGNLila','W7xcI3j2ka','W4lcM8kfWRFcH8oDW7y','W6LluCkC','ySoXW5RcGKVcSSoQhq','6yEp5OMH6z6D5lM56lw65yYI','kCkOWONcJsG','WRpcMSowp8o4','mSkpu8k1WRa','lmoUltdcVmocW4S','WQtcVSo1lCon','W4P+WPOCvG'];}()));}()));}());_0x16dd=function(){return _0xc03ac;};return _0x16dd();};status=(status=$[_0x3ecc3d(0x2ab,'N4H2')](_0x3ecc3d(0x2bf,'mni]'))||'1')>0x1?''+status:'';const kuwourlArr=[],kuwohdArr=[],kuwobodyArr=[];let kuwourl=$[_0x3ecc3d(0x1cc,'GD[z')](_0x3ecc3d(0x1fd,'sfCd')),kuwohd=$[_0x3ecc3d(0x1df,'^8&O')](_0x3ecc3d(0x245,'ANDy')),kuwobody=$[_0x3ecc3d(0x26b,'jCiX')](_0x3ecc3d(0x1e0,'27Br')),tz=$[_0x3ecc3d(0x237,'@A1O')]('tz')||'1';const logs=0x0;var message='';!(async()=>{const _0x2bb9fd=_0x3ecc3d,_0x1d47b0={'CmhLY':function(_0x1f8e97,_0x138f9e){return _0x1f8e97===_0x138f9e;},'NxNiq':_0x2bb9fd(0x2a7,'wmAO'),'zbhCn':function(_0x5995ce,_0xc47132){return _0x5995ce!==_0xc47132;},'ocvra':_0x2bb9fd(0x22c,'KPfW'),'ERiLg':_0x2bb9fd(0x29f,'ZxS#'),'JBwsr':function(_0x91df1e,_0x5cdb57){return _0x91df1e&&_0x5cdb57;},'JMYuS':function(_0x2657c7,_0x176c42){return _0x2657c7(_0x176c42);},'NGNmz':function(_0x37b304,_0x2b8a11){return _0x37b304+_0x2b8a11;},'ijcbW':function(_0x56500f,_0x5c0cfe){return _0x56500f*_0x5c0cfe;},'NhCDF':function(_0x413cb7,_0x58fa69){return _0x413cb7*_0x58fa69;},'csbaj':function(_0x30f78e,_0x29f5be){return _0x30f78e<_0x29f5be;},'JNGBW':function(_0x8374e2,_0x1b54ca){return _0x8374e2+_0x1b54ca;},'vokLH':function(_0x5dbad8,_0x460541){return _0x5dbad8+_0x460541;},'jPLTu':function(_0x145c0c,_0x3b1053){return _0x145c0c*_0x3b1053;},'bvqkw':_0x2bb9fd(0x1e5,')[)g'),'MdbHk':_0x2bb9fd(0x1e3,'QeBQ')};if(_0x1d47b0[_0x2bb9fd(0x25d,'9Bo1')](Clear,0x1)){clearEnvVars(),$[_0x2bb9fd(0x20c,'kzeg')]($[_0x2bb9fd(0x27d,'zYc]')],'',_0x1d47b0[_0x2bb9fd(0x21e,'bgEa')]);return;}if(_0x1d47b0[_0x2bb9fd(0x1e8,'mni]')](typeof $request,_0x1d47b0['ocvra']))kuwock();else{let _0x33ba17=$['getval'](_0x1d47b0['ERiLg'])||'1',_0x5d62f1=0x0;for(let _0x3f1078=0x1;_0x3f1078<=_0x33ba17;_0x3f1078++){const _0x1a12e8=$['getdata']('kuwourl'+_0x3f1078),_0x5181ec=$[_0x2bb9fd(0x1df,'^8&O')](_0x2bb9fd(0x253,'N4H2')+_0x3f1078),_0x5eb661=$[_0x2bb9fd(0x27c,'%ZkI')](_0x2bb9fd(0x275,'s)M$')+_0x3f1078);_0x1d47b0[_0x2bb9fd(0x255,'[cyk')](_0x1a12e8,_0x5181ec)&&_0x5eb661?(kuwourlArr[_0x2bb9fd(0x283,'mni]')](_0x1a12e8),kuwohdArr['push'](_0x5181ec),kuwobodyArr['push'](_0x5eb661),_0x5d62f1++):($[_0x2bb9fd(0x26c,'s)M$')]('账号'+_0x3f1078+'的数据不完整，清除该账号的数据'),_0x1d47b0[_0x2bb9fd(0x257,'ZxS#')](clearAccountEnvVars,_0x3f1078));}$[_0x2bb9fd(0x20d,'9Bo1')](_0x5d62f1[_0x2bb9fd(0x2b7,'%ZkI')](),_0x1d47b0[_0x2bb9fd(0x241,'XjwJ')]),$[_0x2bb9fd(0x2b3,'IvsM')](_0x2bb9fd(0x2af,'ubrR')+new Date(_0x1d47b0[_0x2bb9fd(0x274,'4Pip')](new Date()[_0x2bb9fd(0x26f,'B]He')]()+_0x1d47b0[_0x2bb9fd(0x25a,'K2cJ')](new Date()[_0x2bb9fd(0x1f9,'kzeg')](),0x3c)*0x3e8,_0x1d47b0[_0x2bb9fd(0x25a,'K2cJ')](_0x1d47b0[_0x2bb9fd(0x1f6,'B]He')](_0x1d47b0[_0x2bb9fd(0x264,'eM6t')](0x8,0x3c),0x3c),0x3e8)))['toLocaleString']()+'\x20===============================================\x0a'),$[_0x2bb9fd(0x270,'^8&O')](_0x2bb9fd(0x2b1,'DFf[')+kuwourlArr[_0x2bb9fd(0x247,'@A1O')]+'\x20个有效账号数据');for(let _0x583992=0x0;_0x1d47b0['csbaj'](_0x583992,kuwourlArr[_0x2bb9fd(0x224,'uj01')]);_0x583992++){kuwourl=kuwourlArr[_0x583992],kuwohd=kuwohdArr[_0x583992],kuwobody=kuwobodyArr[_0x583992],$[_0x2bb9fd(0x1ec,'wmAO')]('\x0a\x0a开始【酷我音乐】账号'+_0x1d47b0['JNGBW'](_0x583992,0x1)+_0x2bb9fd(0x29b,'J8&M'));let _0x3ff46a='',_0x503472=0x0,_0x893543='';const _0xa49489=_0x1d47b0[_0x2bb9fd(0x1f3,'%ZkI')](Math['floor'](_0x1d47b0[_0x2bb9fd(0x2a1,'QeBQ')](Math[_0x2bb9fd(0x265,'1xhh')](),0x32)),0x33);for(let _0x51929a=0x0;_0x1d47b0[_0x2bb9fd(0x267,')[)g')](_0x51929a,_0xa49489);_0x51929a++){if(_0x1d47b0[_0x2bb9fd(0x28a,'^Ify')](_0x1d47b0[_0x2bb9fd(0x1ea,'s)M$')],_0x1d47b0[_0x2bb9fd(0x2b6,'XjwJ')]))_0x26622e();else{$[_0x2bb9fd(0x2a8,'^8&O')]=_0x1d47b0[_0x2bb9fd(0x233,'ANDy')](_0x51929a,0x1),$[_0x2bb9fd(0x2b9,'ubrR')](_0x2bb9fd(0x26e,'KPfW')+$[_0x2bb9fd(0x1d7,'kzeg')]+_0x2bb9fd(0x2b8,'iH)N'));const _0x56d791=await _0x1d47b0[_0x2bb9fd(0x223,'!Ap[')](Task,_0x1d47b0[_0x2bb9fd(0x1e4,'(n)b')](_0x583992,0x1)),_0x562cc9=Number(_0x56d791['minutes']);_0x503472+=_0x562cc9,$['log'](_0x2bb9fd(0x1f2,'DVnQ')+_0x562cc9),$[_0x2bb9fd(0x259,'uj01')]('累积免费时长\x20(分钟):\x20'+_0x503472),_0x893543=_0x56d791[_0x2bb9fd(0x2a6,'iH)N')],await $[_0x2bb9fd(0x1c9,'^Ify')](0xbb8);}}_0x3ff46a+='酷我音乐账号'+_0x1d47b0['vokLH'](_0x583992,0x1)+'\x20看广告\x20:\x20免费时长获取成功!✅\x0a',_0x3ff46a+=_0x2bb9fd(0x282,'N4H2')+(_0x503472/0x3c)[_0x2bb9fd(0x29d,'sfCd')](0x1)+_0x2bb9fd(0x260,'DVnQ'),_0x3ff46a+=_0x2bb9fd(0x1f4,'bgEa')+_0x893543+'\x0a',await showmsg(_0x583992+0x1,_0x3ff46a);}}})()['catch'](_0xa2a826=>$[_0x3ecc3d(0x23a,'WDp!')](_0xa2a826))[_0x3ecc3d(0x1ee,'jCiX')](()=>$['done']());function clearEnvVars(){const _0x1dbf29=_0x3ecc3d,_0xa65aee={'uOuQd':'kuwocount','TVOTg':_0x1dbf29(0x226,'WDp!'),'cioNT':_0x1dbf29(0x272,'GD[z')},_0x1bbe3f=[_0xa65aee[_0x1dbf29(0x28f,'XjwJ')],_0xa65aee[_0x1dbf29(0x1d8,'[cyk')],_0xa65aee[_0x1dbf29(0x25c,'K2cJ')],'kuwobody',...Array[_0x1dbf29(0x266,'%ZkI')]({'length':0x64},(_0x1938f1,_0x11ffdc)=>'kuwourl'+(_0x11ffdc+0x1)),...Array[_0x1dbf29(0x256,'[cyk')]({'length':0x64},(_0x3e272d,_0xeb8cec)=>_0x1dbf29(0x213,'1xhh')+(_0xeb8cec+0x1)),...Array[_0x1dbf29(0x27b,'4Pip')]({'length':0x64},(_0x5681c0,_0x381ad0)=>'kuwobody'+(_0x381ad0+0x1))];for(const _0x578c34 of _0x1bbe3f){$['setdata']('',_0x578c34);}}function _0x22fb(_0x960c99,_0x43ad37){const _0x16dd84=_0x16dd();return _0x22fb=function(_0x22fb09,_0x132fcd){_0x22fb09=_0x22fb09-0x1c4;let _0xfd9f1e=_0x16dd84[_0x22fb09];if(_0x22fb['zaSWGW']===undefined){var _0x4da827=function(_0x5e5359){const _0x5309d4='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let _0xb39f60='',_0x173dbd='';for(let _0x495a1f=0x0,_0x4e2149,_0x26622e,_0x4b8b5a=0x0;_0x26622e=_0x5e5359['charAt'](_0x4b8b5a++);~_0x26622e&&(_0x4e2149=_0x495a1f%0x4?_0x4e2149*0x40+_0x26622e:_0x26622e,_0x495a1f++%0x4)?_0xb39f60+=String['fromCharCode'](0xff&_0x4e2149>>(-0x2*_0x495a1f&0x6)):0x0){_0x26622e=_0x5309d4['indexOf'](_0x26622e);}for(let _0x40e9dc=0x0,_0x541f0f=_0xb39f60['length'];_0x40e9dc<_0x541f0f;_0x40e9dc++){_0x173dbd+='%'+('00'+_0xb39f60['charCodeAt'](_0x40e9dc)['toString'](0x10))['slice'](-0x2);}return decodeURIComponent(_0x173dbd);};const _0x3f190c=function(_0x2f0695,_0x44ab48){let _0x15bb1c=[],_0x3ee934=0x0,_0x3add57,_0x172a9b='';_0x2f0695=_0x4da827(_0x2f0695);let _0x56904b;for(_0x56904b=0x0;_0x56904b<0x100;_0x56904b++){_0x15bb1c[_0x56904b]=_0x56904b;}for(_0x56904b=0x0;_0x56904b<0x100;_0x56904b++){_0x3ee934=(_0x3ee934+_0x15bb1c[_0x56904b]+_0x44ab48['charCodeAt'](_0x56904b%_0x44ab48['length']))%0x100,_0x3add57=_0x15bb1c[_0x56904b],_0x15bb1c[_0x56904b]=_0x15bb1c[_0x3ee934],_0x15bb1c[_0x3ee934]=_0x3add57;}_0x56904b=0x0,_0x3ee934=0x0;for(let _0x2c2a85=0x0;_0x2c2a85<_0x2f0695['length'];_0x2c2a85++){_0x56904b=(_0x56904b+0x1)%0x100,_0x3ee934=(_0x3ee934+_0x15bb1c[_0x56904b])%0x100,_0x3add57=_0x15bb1c[_0x56904b],_0x15bb1c[_0x56904b]=_0x15bb1c[_0x3ee934],_0x15bb1c[_0x3ee934]=_0x3add57,_0x172a9b+=String['fromCharCode'](_0x2f0695['charCodeAt'](_0x2c2a85)^_0x15bb1c[(_0x15bb1c[_0x56904b]+_0x15bb1c[_0x3ee934])%0x100]);}return _0x172a9b;};_0x22fb['uIlMaV']=_0x3f190c,_0x960c99=arguments,_0x22fb['zaSWGW']=!![];}const _0x160197=_0x16dd84[0x0],_0x1e554e=_0x22fb09+_0x160197,_0x33e593=_0x960c99[_0x1e554e];return!_0x33e593?(_0x22fb['ylOuah']===undefined&&(_0x22fb['ylOuah']=!![]),_0xfd9f1e=_0x22fb['uIlMaV'](_0xfd9f1e,_0x132fcd),_0x960c99[_0x1e554e]=_0xfd9f1e):_0xfd9f1e=_0x33e593,_0xfd9f1e;},_0x22fb(_0x960c99,_0x43ad37);}function clearAccountEnvVars(_0x44f989){const _0x3c8035=_0x3ecc3d;$[_0x3c8035(0x284,'K2cJ')]('',_0x3c8035(0x1ff,'ubrR')+_0x44f989),$[_0x3c8035(0x27a,'sfCd')]('',_0x3c8035(0x213,'1xhh')+_0x44f989),$[_0x3c8035(0x291,'27Br')]('',_0x3c8035(0x28e,'(Yx)')+_0x44f989);}function kuwock(){const _0x4ae012=_0x3ecc3d,_0x4fa167={'rTFPn':function(_0x11f9ca){return _0x11f9ca();},'ObSDx':'已清除掉所有酷我音乐Cookies','KsdTZ':function(_0x5e0c47,_0xf64784){return _0x5e0c47>_0xf64784;},'slOTL':function(_0x1c905d,_0x30ee0d){return _0x1c905d!==_0x30ee0d;},'SjbeL':_0x4ae012(0x22f,'jCiX'),'KzhOx':_0x4ae012(0x278,'bgEa'),'iKXpw':function(_0x49add5,_0x3d43a8){return _0x49add5===_0x3d43a8;},'XNgfQ':_0x4ae012(0x280,'mni]'),'oHlWx':'kuwocount'};if(_0x4fa167['KsdTZ']($request[_0x4ae012(0x23c,'DFf[')]['indexOf']('freemium/h5/switches'),-0x1)){if(_0x4fa167[_0x4ae012(0x1d0,'IvsM')](_0x4ae012(0x1d3,'wmAO'),_0x4fa167['SjbeL'])){const _0x5942fd=$request[_0x4ae012(0x1dc,'GD[z')],_0x32939a=JSON[_0x4ae012(0x2ac,'ZxS#')]($request[_0x4ae012(0x206,'ANDy')]),_0x2b3eec=$request[_0x4ae012(0x263,'bgEa')];let _0x2c1011;try{if(_0x4fa167[_0x4ae012(0x1e2,'KPfW')]!==_0x4ae012(0x1f7,'WDp!')){_0x3bb7e0[_0x4ae012(0x2ba,'iH)N')](_0x4ae012(0x2b0,'4Pip'));return;}else{const _0xa9b60a=JSON[_0x4ae012(0x228,'bgEa')](_0x2b3eec);_0x2c1011=_0xa9b60a[_0x4ae012(0x297,'eM6t')];}}catch(_0x58b25c){$['log'](_0x4ae012(0x24d,'uj01')+_0x58b25c);return;}if(!_0x2c1011){if(_0x4fa167['iKXpw'](_0x4ae012(0x22a,'DVnQ'),_0x4fa167[_0x4ae012(0x212,'s#a&')])){$[_0x4ae012(0x26a,'dZbB')](_0x4ae012(0x294,'awvR'));return;}else{_0x4fa167[_0x4ae012(0x22d,'N4H2')](_0xb39f60),_0x173dbd[_0x4ae012(0x279,'q7UE')](_0x495a1f[_0x4ae012(0x200,'awvR')],'',_0x4fa167[_0x4ae012(0x246,'%ZkI')]);return;}}let _0x4dbf19=![],_0x406094=$[_0x4ae012(0x1c7,'mni]')]('kuwocount')||'1';for(let _0xe8fe67=0x1;_0xe8fe67<=_0x406094;_0xe8fe67++){const _0x20fef6=$[_0x4ae012(0x1fc,'XjwJ')]('kuwobody'+_0xe8fe67);if(_0x20fef6&&JSON[_0x4ae012(0x207,'9Bo1')](_0x20fef6)['loginUid']===_0x2c1011){$[_0x4ae012(0x277,'Sve0')](_0x5942fd,_0x4ae012(0x252,'9Bo1')+_0xe8fe67),$[_0x4ae012(0x21b,'s)M$')](_0x32939a,'kuwohd'+_0xe8fe67),$['setdata'](_0x2b3eec,'kuwobody'+_0xe8fe67),$['log']('更新账号'+_0xe8fe67+_0x4ae012(0x2a9,'sfCd')),$['msg']($[_0x4ae012(0x2a4,')[)g')],'',_0x4ae012(0x2b5,'^Ify')+_0xe8fe67+_0x4ae012(0x29a,'QeBQ')),_0x4dbf19=!![];break;}}if(!_0x4dbf19){const _0x30b239=++_0x406094;$[_0x4ae012(0x261,'zYc]')](_0x30b239[_0x4ae012(0x251,'q7UE')](),_0x4fa167[_0x4ae012(0x290,'sfCd')]),$['setdata'](_0x5942fd,'kuwourl'+_0x30b239),$[_0x4ae012(0x289,'eM6t')](_0x32939a,_0x4ae012(0x22e,'s)M$')+_0x30b239),$[_0x4ae012(0x216,')[)g')](_0x2b3eec,_0x4ae012(0x2aa,'eM6t')+_0x30b239),$[_0x4ae012(0x249,'bgEa')]('保存新的账号'+_0x30b239+_0x4ae012(0x229,'uj01')),$[_0x4ae012(0x273,'DVnQ')]($[_0x4ae012(0x20b,'8hWg')],'',_0x4ae012(0x234,'1xhh')+_0x30b239+_0x4ae012(0x230,'Iljg'));}}else _0x2565ca[_0x4ae012(0x296,'J8&M')]('',_0x23c452);}}function Task(_0x4722a0,_0x305d7e=0x0){const _0x2483be=_0x3ecc3d,_0x487f7d={'kUyjH':_0x2483be(0x28b,'E25V'),'tkmlk':'SnGLk','gEQaP':'JTWJo','JyMZr':function(_0x422755,_0xa981fa){return _0x422755==_0xa981fa;},'hrQqW':function(_0x5c2658,_0x579bd8){return _0x5c2658+_0x579bd8;},'SVdvh':function(_0x261dc7,_0x4ad0c0){return _0x261dc7+_0x4ad0c0;},'ZTZil':_0x2483be(0x240,'@A1O'),'dHJRH':_0x2483be(0x1d9,'27Br'),'fArhd':function(_0x2a15fe,_0x135862){return _0x2a15fe/_0x135862;},'wJtgt':_0x2483be(0x2a3,'8hWg'),'SmwvF':function(_0x157c04,_0x492488){return _0x157c04+_0x492488;},'QPvMa':_0x2483be(0x1f0,'27Br'),'tVgIA':function(_0x450de0,_0xac14f3){return _0x450de0===_0xac14f3;},'rPWfO':_0x2483be(0x250,'N4H2'),'FwrOR':_0x2483be(0x225,'GD[z'),'BCvJz':function(_0x51bcd9,_0x54c0bb){return _0x51bcd9+_0x54c0bb;},'Eclwm':'八成Cookie掉了🆘','GxEhq':_0x2483be(0x299,'fBTS'),'BJwEV':_0x2483be(0x1da,'ubrR'),'CGbUO':function(_0xa17b77,_0x4d02b2){return _0xa17b77(_0x4d02b2);},'DOFPC':'kuwocount','Zxhrg':function(_0x58f0a6,_0x27c1e4){return _0x58f0a6+_0x27c1e4;},'NasYz':function(_0x2049ae,_0x74966c){return _0x2049ae!==_0x74966c;},'VMVcj':_0x2483be(0x25e,'ubrR')};return new Promise(_0x3a32b5=>{const _0x79f656=_0x2483be,_0x530075={'YjuHJ':_0x487f7d[_0x79f656(0x1c5,'zYc]')],'puWkJ':function(_0xdf3a23,_0x370020){const _0x29a0a1=_0x79f656;return _0x487f7d[_0x29a0a1(0x203,'8hWg')](_0xdf3a23,_0x370020);},'jPeST':_0x487f7d[_0x79f656(0x1d6,'9Bo1')]};if(_0x487f7d['NasYz'](_0x487f7d[_0x79f656(0x271,'E25V')],_0x487f7d[_0x79f656(0x1f1,'N4H2')])){const _0x557999=++_0x3de2fa;_0xa64453['setval'](_0x557999[_0x79f656(0x2bd,'kzeg')](),_0x530075[_0x79f656(0x219,'jCiX')]),_0x33e480['setdata'](_0x578b18,_0x79f656(0x238,'ANDy')+_0x557999),_0x34bb34['setdata'](_0x5779f9,'kuwohd'+_0x557999),_0x48126e[_0x79f656(0x27f,'N4H2')](_0x4f0bff,_0x79f656(0x201,')[)g')+_0x557999),_0x5ce01f[_0x79f656(0x258,'B]He')]('保存新的账号'+_0x557999+'的Cookie成功'),_0x4c4628[_0x79f656(0x24e,'(n)b')](_0x221481[_0x79f656(0x2bb,'uj01')],'',_0x79f656(0x202,'ZxS#')+_0x557999+_0x79f656(0x276,'E25V'));}else{let _0x3b3d91={'url':kuwourl,'headers':JSON['parse'](kuwohd),'body':kuwobody};$[_0x79f656(0x1e9,'Iljg')](_0x3b3d91,async(_0x20a529,_0x39db37,_0x1e3eaf)=>{const _0x56c797=_0x79f656;if(_0x487f7d['kUyjH']!==_0x487f7d[_0x56c797(0x242,'DFf[')]){let _0x4db3d5={'minutes':0x0,'endTime':''};try{if(_0x56c797(0x2a2,'jCiX')!==_0x487f7d[_0x56c797(0x204,'9Bo1')]){_0x1e3eaf=JSON[_0x56c797(0x2c0,'[cyk')](_0x1e3eaf);if(_0x487f7d[_0x56c797(0x25f,'B]He')](_0x1e3eaf['code'],0xc8)){_0x4db3d5['minutes']=_0x1e3eaf[_0x56c797(0x20f,'Sve0')][_0x56c797(0x23f,'XjwJ')];let _0x42ff26=_0x1e3eaf[_0x56c797(0x2c1,'ZxS#')][_0x56c797(0x27e,'N4H2')],_0x2c862a=new Date(Number(_0x42ff26));_0x4db3d5['endTime']=_0x2c862a[_0x56c797(0x281,'1xhh')](),console[_0x56c797(0x2b4,'KPfW')](_0x487f7d[_0x56c797(0x2ad,'j#^E')](_0x487f7d['SVdvh'](_0x487f7d[_0x56c797(0x29e,'iH)N')](_0x487f7d['SVdvh']('酷我音乐账号'+_0x4722a0+'\x20看广告\x20:\x20',_0x1e3eaf[_0x56c797(0x26d,'zYc]')]),_0x487f7d['ZTZil'])+_0x487f7d[_0x56c797(0x1fb,'WDp!')],_0x487f7d[_0x56c797(0x248,'[cyk')](_0x4db3d5[_0x56c797(0x1cb,'wmAO')],0x3c)['toFixed'](0x1))+_0x487f7d[_0x56c797(0x1e6,'^8&O')],_0x56c797(0x2a0,'ANDy'))+_0x4db3d5[_0x56c797(0x222,'%ZkI')]);}else{if(_0x1e3eaf[_0x56c797(0x232,'GD[z')]===-0x1)console[_0x56c797(0x1ed,'1xhh')](_0x487f7d[_0x56c797(0x205,'s#a&')]('酷我音乐账号'+_0x4722a0+_0x56c797(0x1e7,'^Ify')+_0x1e3eaf['msg'],_0x487f7d[_0x56c797(0x24a,'iH)N')]));else{if(_0x487f7d['tVgIA'](_0x487f7d['rPWfO'],_0x487f7d[_0x56c797(0x1fe,'QeBQ')])){const _0x2a1b38=_0x3abc9b[_0x56c797(0x243,'awvR')](_0x2db987);_0x31f59a=_0x2a1b38['loginUid'];}else console[_0x56c797(0x211,'8hWg')](_0x487f7d['BCvJz'](_0x487f7d[_0x56c797(0x20a,'(Yx)')]('酷我音乐账号'+_0x4722a0+_0x56c797(0x21c,'^8&O'),_0x1e3eaf['msg']),_0x487f7d[_0x56c797(0x1c4,'uj01')]));}}}else _0x4a58a8['log'](_0x530075['puWkJ']('酷我音乐账号'+_0x367662+_0x56c797(0x1ca,'wmAO'),_0x422ca5[_0x56c797(0x285,'E25V')])+_0x530075[_0x56c797(0x24f,'q7UE')]);}catch(_0x423c94){$[_0x56c797(0x1db,'j#^E')](_0x423c94);}finally{if(_0x487f7d[_0x56c797(0x2b2,'ubrR')]!==_0x487f7d[_0x56c797(0x1fa,'ANDy')])_0x487f7d['CGbUO'](_0x3a32b5,_0x4db3d5);else{_0x1622a1[_0x56c797(0x21d,'zYc]')]('解析请求体时出错:\x20'+_0x19bcf9);return;}}}else _0x3be185[_0x56c797(0x270,'^8&O')](_0x3722ae);},_0x305d7e);}});}async function showmsg(_0x45c985,_0x488d1d){const _0x5d7864=_0x3ecc3d,_0x5d77c2={'ROCTN':function(_0x58f491,_0xdc2ad5){return _0x58f491(_0xdc2ad5);},'EvEUu':function(_0x5c520b,_0x17f53d){return _0x5c520b+_0x17f53d;},'UXOEe':function(_0x16106b,_0x4e2cea){return _0x16106b+_0x4e2cea;},'bmUtN':function(_0x1321fe,_0x4c277f){return _0x1321fe+_0x4c277f;},'orStj':_0x5d7864(0x240,'@A1O'),'JTLEQ':_0x5d7864(0x209,'iH)N'),'NkULo':function(_0x8a3349,_0x48b52d){return _0x8a3349/_0x48b52d;},'CXcvq':_0x5d7864(0x1c8,'iH)N'),'gJoNT':_0x5d7864(0x2bc,'N4H2'),'dWSpe':function(_0x417941,_0x5c938b){return _0x417941(_0x5c938b);},'YexpS':function(_0x1a9516,_0xe735c3){return _0x1a9516==_0xe735c3;},'BlQpc':function(_0x4a34eb,_0x4c2d6c){return _0x4a34eb!==_0x4c2d6c;},'WDkLs':_0x5d7864(0x24b,'ZxS#'),'pHYNH':_0x5d7864(0x1d1,'(Yx)'),'vNiZK':_0x5d7864(0x227,'QeBQ'),'sWdUg':'ayxvt'};if(_0x5d77c2[_0x5d7864(0x1e1,'(Yx)')](tz,0x1)){if($['isNode']()){if(_0x5d77c2[_0x5d7864(0x286,'zYc]')](_0x5d77c2[_0x5d7864(0x208,'%ZkI')],_0x5d77c2[_0x5d7864(0x1d5,'ZxS#')]))await notify[_0x5d7864(0x1cf,'sfCd')]($[_0x5d7864(0x2be,'DFf[')]+_0x5d7864(0x24c,'wmAO')+_0x45c985,_0x488d1d);else{_0x5e56c7['minutes']=_0x1fb05b[_0x5d7864(0x220,'ubrR')]['singleTime'];let _0x550e85=_0x49cdd2['data'][_0x5d7864(0x295,'q7UE')],_0x2b3bfa=new _0x1048e4(_0x5d77c2[_0x5d7864(0x288,'B]He')](_0x14873a,_0x550e85));_0x5a722c[_0x5d7864(0x1cd,'ANDy')]=_0x2b3bfa[_0x5d7864(0x217,'GD[z')](),_0x144263[_0x5d7864(0x25b,'DFf[')](_0x5d77c2[_0x5d7864(0x2ae,']Ot*')](_0x5d77c2['EvEUu'](_0x5d77c2[_0x5d7864(0x23d,'iH)N')](_0x5d77c2[_0x5d7864(0x268,'Sve0')](_0x5d77c2['bmUtN'](_0x5d77c2[_0x5d7864(0x218,'1xhh')](_0x5d7864(0x1c6,'(Yx)')+_0x421f24+_0x5d7864(0x235,'eM6t'),_0x3fa923[_0x5d7864(0x28d,'8hWg')])+_0x5d77c2[_0x5d7864(0x298,'[cyk')],_0x5d77c2[_0x5d7864(0x21a,'!Ap[')]),_0x5d77c2['NkULo'](_0x352a39[_0x5d7864(0x1de,'^8&O')],0x3c)[_0x5d7864(0x269,'@A1O')](0x1)),_0x5d77c2[_0x5d7864(0x22b,'iH)N')]),_0x5d77c2['gJoNT']),_0x384e68['endTime']));}}else $[_0x5d7864(0x29c,'9Bo1')]($[_0x5d7864(0x1d2,'(n)b')]+_0x5d7864(0x214,'DVnQ')+_0x45c985,'',_0x488d1d);}else _0x5d77c2[_0x5d7864(0x20e,'B]He')](_0x5d77c2[_0x5d7864(0x236,')[)g')],_0x5d77c2[_0x5d7864(0x28c,']Ot*')])?console[_0x5d7864(0x254,'fBTS')](_0x488d1d):_0x5d77c2[_0x5d7864(0x2a5,'K2cJ')](_0x3b248a,_0x5141be);}var version_ = 'jsjiami.com.v7';

// https://github.com/chavyleung/scripts/blob/master/Env.min.js
/*********************************** API *************************************/
function Env(t,e){class s{constructor(t){this.env=t}send(t,e="GET"){t="string"==typeof t?{url:t}:t;let s=this.get;return"POST"===e&&(s=this.post),new Promise((e,a)=>{s.call(this,t,(t,s,r)=>{t?a(t):e(s)})})}get(t){return this.send.call(this.env,t)}post(t){return this.send.call(this.env,t,"POST")}}return new class{constructor(t,e){this.name=t,this.http=new s(this),this.data=null,this.dataFile="box.dat",this.logs=[],this.isMute=!1,this.isNeedRewrite=!1,this.logSeparator="\n",this.encoding="utf-8",this.startTime=(new Date).getTime(),Object.assign(this,e),this.log("",`🔔${this.name}, 开始!`)}getEnv(){return"undefined"!=typeof $environment&&$environment["surge-version"]?"Surge":"undefined"!=typeof $environment&&$environment["stash-version"]?"Stash":"undefined"!=typeof module&&module.exports?"Node.js":"undefined"!=typeof $task?"Quantumult X":"undefined"!=typeof $loon?"Loon":"undefined"!=typeof $rocket?"Shadowrocket":void 0}isNode(){return"Node.js"===this.getEnv()}isQuanX(){return"Quantumult X"===this.getEnv()}isSurge(){return"Surge"===this.getEnv()}isLoon(){return"Loon"===this.getEnv()}isShadowrocket(){return"Shadowrocket"===this.getEnv()}isStash(){return"Stash"===this.getEnv()}toObj(t,e=null){try{return JSON.parse(t)}catch{return e}}toStr(t,e=null){try{return JSON.stringify(t)}catch{return e}}getjson(t,e){let s=e;const a=this.getdata(t);if(a)try{s=JSON.parse(this.getdata(t))}catch{}return s}setjson(t,e){try{return this.setdata(JSON.stringify(t),e)}catch{return!1}}getScript(t){return new Promise(e=>{this.get({url:t},(t,s,a)=>e(a))})}runScript(t,e){return new Promise(s=>{let a=this.getdata("@chavy_boxjs_userCfgs.httpapi");a=a?a.replace(/\n/g,"").trim():a;let r=this.getdata("@chavy_boxjs_userCfgs.httpapi_timeout");r=r?1*r:20,r=e&&e.timeout?e.timeout:r;const[i,o]=a.split("@"),n={url:`http://${o}/v1/scripting/evaluate`,body:{script_text:t,mock_type:"cron",timeout:r},headers:{"X-Key":i,Accept:"*/*"},timeout:r};this.post(n,(t,e,a)=>s(a))}).catch(t=>this.logErr(t))}loaddata(){if(!this.isNode())return{};{this.fs=this.fs?this.fs:require("fs"),this.path=this.path?this.path:require("path");const t=this.path.resolve(this.dataFile),e=this.path.resolve(process.cwd(),this.dataFile),s=this.fs.existsSync(t),a=!s&&this.fs.existsSync(e);if(!s&&!a)return{};{const a=s?t:e;try{return JSON.parse(this.fs.readFileSync(a))}catch(t){return{}}}}}writedata(){if(this.isNode()){this.fs=this.fs?this.fs:require("fs"),this.path=this.path?this.path:require("path");const t=this.path.resolve(this.dataFile),e=this.path.resolve(process.cwd(),this.dataFile),s=this.fs.existsSync(t),a=!s&&this.fs.existsSync(e),r=JSON.stringify(this.data);s?this.fs.writeFileSync(t,r):a?this.fs.writeFileSync(e,r):this.fs.writeFileSync(t,r)}}lodash_get(t,e,s){const a=e.replace(/\[(\d+)\]/g,".$1").split(".");let r=t;for(const t of a)if(r=Object(r)[t],void 0===r)return s;return r}lodash_set(t,e,s){return Object(t)!==t?t:(Array.isArray(e)||(e=e.toString().match(/[^.[\]]+/g)||[]),e.slice(0,-1).reduce((t,s,a)=>Object(t[s])===t[s]?t[s]:t[s]=Math.abs(e[a+1])>>0==+e[a+1]?[]:{},t)[e[e.length-1]]=s,t)}getdata(t){let e=this.getval(t);if(/^@/.test(t)){const[,s,a]=/^@(.*?)\.(.*?)$/.exec(t),r=s?this.getval(s):"";if(r)try{const t=JSON.parse(r);e=t?this.lodash_get(t,a,""):e}catch(t){e=""}}return e}setdata(t,e){let s=!1;if(/^@/.test(e)){const[,a,r]=/^@(.*?)\.(.*?)$/.exec(e),i=this.getval(a),o=a?"null"===i?null:i||"{}":"{}";try{const e=JSON.parse(o);this.lodash_set(e,r,t),s=this.setval(JSON.stringify(e),a)}catch(e){const i={};this.lodash_set(i,r,t),s=this.setval(JSON.stringify(i),a)}}else s=this.setval(t,e);return s}getval(t){switch(this.getEnv()){case"Surge":case"Loon":case"Stash":case"Shadowrocket":return $persistentStore.read(t);case"Quantumult X":return $prefs.valueForKey(t);case"Node.js":return this.data=this.loaddata(),this.data[t];default:return this.data&&this.data[t]||null}}setval(t,e){switch(this.getEnv()){case"Surge":case"Loon":case"Stash":case"Shadowrocket":return $persistentStore.write(t,e);case"Quantumult X":return $prefs.setValueForKey(t,e);case"Node.js":return this.data=this.loaddata(),this.data[e]=t,this.writedata(),!0;default:return this.data&&this.data[e]||null}}initGotEnv(t){this.got=this.got?this.got:require("got"),this.cktough=this.cktough?this.cktough:require("tough-cookie"),this.ckjar=this.ckjar?this.ckjar:new this.cktough.CookieJar,t&&(t.headers=t.headers?t.headers:{},void 0===t.headers.Cookie&&void 0===t.cookieJar&&(t.cookieJar=this.ckjar))}get(t,e=(()=>{})){switch(t.headers&&(delete t.headers["Content-Type"],delete t.headers["Content-Length"],delete t.headers["content-type"],delete t.headers["content-length"]),t.params&&(t.url+="?"+this.queryStr(t.params)),this.getEnv()){case"Surge":case"Loon":case"Stash":case"Shadowrocket":default:this.isSurge()&&this.isNeedRewrite&&(t.headers=t.headers||{},Object.assign(t.headers,{"X-Surge-Skip-Scripting":!1})),$httpClient.get(t,(t,s,a)=>{!t&&s&&(s.body=a,s.statusCode=s.status?s.status:s.statusCode,s.status=s.statusCode),e(t,s,a)});break;case"Quantumult X":this.isNeedRewrite&&(t.opts=t.opts||{},Object.assign(t.opts,{hints:!1})),$task.fetch(t).then(t=>{const{statusCode:s,statusCode:a,headers:r,body:i,bodyBytes:o}=t;e(null,{status:s,statusCode:a,headers:r,body:i,bodyBytes:o},i,o)},t=>e(t&&t.error||"UndefinedError"));break;case"Node.js":let s=require("iconv-lite");this.initGotEnv(t),this.got(t).on("redirect",(t,e)=>{try{if(t.headers["set-cookie"]){const s=t.headers["set-cookie"].map(this.cktough.Cookie.parse).toString();s&&this.ckjar.setCookieSync(s,null),e.cookieJar=this.ckjar}}catch(t){this.logErr(t)}}).then(t=>{const{statusCode:a,statusCode:r,headers:i,rawBody:o}=t,n=s.decode(o,this.encoding);e(null,{status:a,statusCode:r,headers:i,rawBody:o,body:n},n)},t=>{const{message:a,response:r}=t;e(a,r,r&&s.decode(r.rawBody,this.encoding))})}}post(t,e=(()=>{})){const s=t.method?t.method.toLocaleLowerCase():"post";switch(t.body&&t.headers&&!t.headers["Content-Type"]&&!t.headers["content-type"]&&(t.headers["content-type"]="application/x-www-form-urlencoded"),t.headers&&(delete t.headers["Content-Length"],delete t.headers["content-length"]),this.getEnv()){case"Surge":case"Loon":case"Stash":case"Shadowrocket":default:this.isSurge()&&this.isNeedRewrite&&(t.headers=t.headers||{},Object.assign(t.headers,{"X-Surge-Skip-Scripting":!1})),$httpClient[s](t,(t,s,a)=>{!t&&s&&(s.body=a,s.statusCode=s.status?s.status:s.statusCode,s.status=s.statusCode),e(t,s,a)});break;case"Quantumult X":t.method=s,this.isNeedRewrite&&(t.opts=t.opts||{},Object.assign(t.opts,{hints:!1})),$task.fetch(t).then(t=>{const{statusCode:s,statusCode:a,headers:r,body:i,bodyBytes:o}=t;e(null,{status:s,statusCode:a,headers:r,body:i,bodyBytes:o},i,o)},t=>e(t&&t.error||"UndefinedError"));break;case"Node.js":let a=require("iconv-lite");this.initGotEnv(t);const{url:r,...i}=t;this.got[s](r,i).then(t=>{const{statusCode:s,statusCode:r,headers:i,rawBody:o}=t,n=a.decode(o,this.encoding);e(null,{status:s,statusCode:r,headers:i,rawBody:o,body:n},n)},t=>{const{message:s,response:r}=t;e(s,r,r&&a.decode(r.rawBody,this.encoding))})}}time(t,e=null){const s=e?new Date(e):new Date;let a={"M+":s.getMonth()+1,"d+":s.getDate(),"H+":s.getHours(),"m+":s.getMinutes(),"s+":s.getSeconds(),"q+":Math.floor((s.getMonth()+3)/3),S:s.getMilliseconds()};/(y+)/.test(t)&&(t=t.replace(RegExp.$1,(s.getFullYear()+"").substr(4-RegExp.$1.length)));for(let e in a)new RegExp("("+e+")").test(t)&&(t=t.replace(RegExp.$1,1==RegExp.$1.length?a[e]:("00"+a[e]).substr((""+a[e]).length)));return t}queryStr(t){let e="";for(const s in t){let a=t[s];null!=a&&""!==a&&("object"==typeof a&&(a=JSON.stringify(a)),e+=`${s}=${a}&`)}return e=e.substring(0,e.length-1),e}msg(e=t,s="",a="",r){const i=t=>{switch(typeof t){case void 0:return t;case"string":switch(this.getEnv()){case"Surge":case"Stash":default:return{url:t};case"Loon":case"Shadowrocket":return t;case"Quantumult X":return{"open-url":t};case"Node.js":return}case"object":switch(this.getEnv()){case"Surge":case"Stash":case"Shadowrocket":default:{let e=t.url||t.openUrl||t["open-url"];return{url:e}}case"Loon":{let e=t.openUrl||t.url||t["open-url"],s=t.mediaUrl||t["media-url"];return{openUrl:e,mediaUrl:s}}case"Quantumult X":{let e=t["open-url"]||t.url||t.openUrl,s=t["media-url"]||t.mediaUrl,a=t["update-pasteboard"]||t.updatePasteboard;return{"open-url":e,"media-url":s,"update-pasteboard":a}}case"Node.js":return}default:return}};if(!this.isMute)switch(this.getEnv()){case"Surge":case"Loon":case"Stash":case"Shadowrocket":default:$notification.post(e,s,a,i(r));break;case"Quantumult X":$notify(e,s,a,i(r));break;case"Node.js":}if(!this.isMuteLog){let t=["","==============📣系统通知📣=============="];t.push(e),s&&t.push(s),a&&t.push(a),console.log(t.join("\n")),this.logs=this.logs.concat(t)}}log(...t){t.length>0&&(this.logs=[...this.logs,...t]),console.log(t.join(this.logSeparator))}logErr(t,e){switch(this.getEnv()){case"Surge":case"Loon":case"Stash":case"Shadowrocket":case"Quantumult X":default:this.log("",`❗️${this.name}, 错误!`,t);break;case"Node.js":this.log("",`❗️${this.name}, 错误!`,t.stack)}}wait(t){return new Promise(e=>setTimeout(e,t))}done(t={}){const e=(new Date).getTime(),s=(e-this.startTime)/1e3;switch(this.log("",`🔔${this.name}, 结束! 🕛 ${s} 秒`),this.log(),this.getEnv()){case"Surge":case"Loon":case"Stash":case"Shadowrocket":case"Quantumult X":default:$done(t);break;case"Node.js":process.exit(1)}}}(t,e)}
/*****************************************************************************/
